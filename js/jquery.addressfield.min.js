/*! Address Field - v0.1.2 - 2014-05-12
* https://github.com/tableau-mkt/jquery.addressfield
* Copyright (c) 2014 Eric Peterson; Licensed GPL-2.0 */
!function(a){a.fn.addressfield=function(b,c){var d,e,f=a(this),g=[];for(e in b)if("object"==typeof b[e]){if(d=f.find("."+e),!b[e].hasOwnProperty("label"))return a.fn.addressfield.call(d,b[e],c);d.length&&-1!==a.inArray(e,c)&&(g.push(e),"undefined"!=typeof b[e].options?(d.is("select")||(d=a.fn.addressfield.convertToSelect.call(d)),a.fn.addressfield.updateOptions.call(d,b[e].options)):d.is("select")&&(d=a.fn.addressfield.convertToText.call(d)),a.fn.addressfield.updateLabel.call(d,b[e].label)),d.not(":visible")&&-1!==a.inArray(e,c)&&a.fn.addressfield.showField.call(d)}return a.each(c,function(c,d){var e=f.find("."+d);e.length&&!b.hasOwnProperty(d)&&a.fn.addressfield.hideField.call(e)}),a.fn.addressfield.orderFields.call(f,g),this},a.fn.addressfield.updateLabel=function(b){a(this).prev("label").length&&a(this).prev("label").text(b)},a.fn.addressfield.updateOptions=function(b){var c=a(this),d=c.data("_saved")||c.val();c.children("option").remove(),a.each(b,function(b,d){c.append(a("<option></option>").attr("value",b).text(d))}),c.val(d).change(),c.removeData("_saved")},a.fn.addressfield.convertToText=function(){var b=a(this),c=a("<input />").attr("type","text");return a.each(b[0].attributes,function(){-1!==a.inArray(this.name,["class","id","name"])&&c.attr(this.name,this.value)}),c.val(b.val()),b.replaceWith(c),c},a.fn.addressfield.convertToSelect=function(){var b=a(this),c=a("<select></select>");return a.each(b[0].attributes,function(){-1!==a.inArray(this.name,["class","id","name"])&&c.attr(this.name,this.value)}),c.data("_saved",b.val()),b.replaceWith(c),c},a.fn.addressfield.hideField=function(){a(this).val(""),a(this).parent().hide()},a.fn.addressfield.showField=function(){a(this).parent().show()},a.fn.addressfield.orderFields=function(b){var c,d=b.length,e=0;for(e;d>e;++e)e in b&&(c=a(this).find("."+b[e]).parent("div, section"),b[e]={element:c.clone(),"class":b[e],value:a(this).find("."+b[e]).val()},c.remove());for(e=0;d>e;++e)e in b&&(c=a(this).append(b[e].element),c.find("."+b[e].class).val(b[e].value).change())}}(jQuery);